---
title: "Esports: League of Legends"
author: "*Charlie Tran*"
date: "12/18/2020"
output: 
  html_document:
    keep_md: TRUE
    toc: TRUE
    toc_float: TRUE
    df_print: paged
    code_download: true
    theme: united
  
---


```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE, error=TRUE, message=FALSE, warning=FALSE)
```

```{r libraries, echo=FALSE}
library(tidyverse)     # for data cleaning and plotting
library(lubridate)     # for date manipulation
library(ggthemes)      # for more themes (including theme_map())
library(gganimate)     # for adding animation layers to ggplots
library(gifski)        # for creating the gif (don't need to load this library every time,but need it installed)
library(transformr)    # for "tweening" (gganimate)
library(patchwork)     # for nicely combining ggplot2 graphs  
library(gt)            # for creating nice tables
library(stringr)       # for string conversions
library(ggimage)       # for reading in images
```

```{r data, echo = FALSE}
GeneralEsportData <- read.csv("GeneralEsportData.csv")

HistoricalEsportData <- read.csv("HistoricalEsportData.csv") %>% 
  mutate(Date = dmy(Date)) %>% 
  mutate(year = year(Date))

high_diamond_ranked_10min <- read.csv("high_diamond_ranked_10min.csv")

twitchdata <- read.csv("twitchdata.csv")

pro_lol_champs <- read.csv("champion_stats.csv")

pro_lol_matches <- read.csv("matches2020.csv")

team_earnings <- read.csv("ee.csv")

lol_tournament_earnings <- read.csv("lolearningsbyteam.csv")
```

## The Growing Esports Industry

-briefly discuss the growing industry and the history and games associated with the industry
  - end with with introducing the recent competiiton of league of legends and the affeect of the pandemic
  
- use the general and historical esports data
  - probably a line graph where the dates can be utilized
  
-add images for: Space Invaders, twin galaxies,
  
The first competitive games started on arcade machines in the late 1970s with Space Invader and Twin Galaxies where the professional players strive to beat each other's record to become the world record holder. In the 1980s, more games were released that many of us know today like Pac-Man. A shift from arcades to gaming consoles occurred with the release of Nintendo systems. The new popularized way of gaming was becoming more accessible to the average consumer than ever before. As Nintendo continued to grow through the 1990s, the fast advancing computer technology became a new and different mode of gaming with personal computers. 

The large amount of competitive users led to organized competitions where tens of millions of fans of the top games follow these matches allowing the game companies to profit. Eventually these competitive matches transformed into a sport known as Esports. Many of the top games help create and influence the start of Esports teams and organizations made of world-class gamers. In total, hundreds of millions of US dollars are profitted from the Esports industries only in terms of prize earnings from professional tournaments. 
```{r echo = FALSE}
barlinegraph <- HistoricalEsportData %>% 
  group_by(year) %>% 
  summarise(sumEarnings = sum(Earnings)/1000000) 
  
  
growth_time <- ggplot(barlinegraph, aes(x = year,
             y = sumEarnings))+
  geom_col(color = "darkblue",
           fill = "white")+
  geom_line(color = "red",
            size = 1)+
  labs(title = "Esports Professional Matches Prize Earnings",
       subtitle = "(Millions of US Dollars)",
       x = "",
       y = "",
       caption = "Data from EsportsEarnings.com")+
  theme_minimal()

perspectivebar <- HistoricalEsportData %>% 
  mutate(era = ifelse(year >= 1998 & year <= 2017,
                      "1998 - 2017",
                      "2018 - 2020")) %>%
  group_by(era) %>%
  summarise(total_earnings = sum(Earnings)/1000000) %>% 
  ggplot(aes(x = era,
             y = total_earnings,
             fill = era))+
  geom_col()+
  labs(y = "",
       x = "",
       caption = "Created by Charlie Tran")+
  theme_minimal()+
  theme(legend.position = "none")

growth_time + perspectivebar 
```

As seen above, in late 1990s to the late 2010s there was a exponential growth in the tournaments' prize earnings from all Esports teams, orgnaizations, and all variety of competitive. In fact the earnings from tournaments in the last 3 years totals to more than the 20 years before! Unfortunately for the Esports industry in 2020, the toll of the COVID-19 pandemic is evident where large gatherings were impossible to view the professional matches. the canceled tournaments destryed the potential of growth of Esports although some game companies like Riot Games worked with the teams to provide a remote competitive experience to provide a fair tournament to take place (more on this later).

These Esports organizations are created with a focus on a specific game and eventually grow from tournament prizes.

```{r, echo=FALSE}
library(ggimage)
library(png)

top_team_earnings <- team_earnings %>% 
  arrange(desc(TotalUSDPrize)) %>% 
  filter(TotalUSDPrize > 9000000)

teamliquid <- "Team_Liquidlogo.png"
og <- "OG_Esportslogo.png"
evilgeniuses <- "eglogo.png"
fnatic <- "Fnaticlogo_square.png"
virtus.por <- "Virtus.prologo_square.png"
newbee <- "Newbeelogo_square.png"
vicigaming <- "600px-VICI_Gaming.png"
teamsecret <- "Team_Secret_(Vietnamese_Team)logo_square.png"
invictusgaming <- "png-transparent-dota-2-asia-championships-2015-the-international-2014-invictus-gaming-evil-geniuses-others-game-burning-logo.png"
natusvincere <- "NaVi_logo.png"
lgdgaming <- "LGD_Gaminglogo_square.png"
cloud9 <- "1280px-Cloud9_logo.svg.png"
skt <- "SK_Telecom_T1logo_square.png"
wingsgaming <- "600px-Wings.png"
parissaintgermain <- "Paris_Saint-Germain_eSportslogo_square.png"
fazeclan <- "1200px-Faze_Clan.svg.png"

top_team_images <- tibble(image = c(teamliquid, og, evilgeniuses, fnatic, virtus.por, newbee,
                                       vicigaming, teamsecret, invictusgaming, natusvincere, lgdgaming,
                                       cloud9, skt, wingsgaming, parissaintgermain, fazeclan))

top_team_earnings_images <- top_team_earnings %>% 
  mutate(top_team_images)

top_team_earnings_images %>% 
  ggplot(aes(x = TotalUSDPrize/1000000,
               y = fct_reorder(TeamName, TotalUSDPrize),
             fill = TotalUSDPrize))+
  geom_col()+
  geom_image(aes(image = image), 
             size = 0.05)+
  theme_minimal()+
  theme(legend.position = "none")+
  scale_x_continuous()+
  labs(title = "Total Tournament Earnings by Team",
       subtitle = "(Millions of US Dollars)",
       x = "",
       y = "",
       caption = "Data from EsportsEarnings.com, Created by Charlie Tran")
```

The bargraph above shows the top Esports organzations/teams around the world with teams that have contracted professional players who competed in professional matches and earn the tournaments prizes. One of the games that provide one the largest percent of the organization's total earnings is League of Legends

```{r}
lol_vs_total_earnings <- lol_tournament_earnings %>% 
  filter(TeamName %in% c("Team Liquid", "OG", "Evil Geniuses", "Fnatic", "Virtus.pro", "Newbee",
                       "Vici Gaming", "Team Secret", "Invictus Gaming", "Natus Vincere", "LGD Gaming",
                       "Cloud9", "SK Telecom T1", "Wings Gaming", "Paris Saint-Germain Esports", 
                       "Faze Clan")) %>% 
  left_join(top_team_earnings,
            by = "TeamName") %>% 
  select(-starts_with("TeamId")) %>% 
  select(-starts_with("TotalTour")) %>% 
  pivot_longer(cols = starts_with("TotalUSDPrize"),
               names_to = "variable",
               values_to = "prize_earnings")

percentage_lol_earnings <- lol_tournament_earnings %>% 
  filter(TeamName %in% c("Team Liquid", "OG", "Evil Geniuses", "Fnatic", "Virtus.pro", "Newbee",
                       "Vici Gaming", "Team Secret", "Invictus Gaming", "Natus Vincere", "LGD Gaming",
                       "Cloud9", "SK Telecom T1", "Wings Gaming", "Paris Saint-Germain Esports", 
                       "Faze Clan")) %>% 
  left_join(top_team_earnings,
            by = "TeamName") %>% 
  select(-starts_with("TeamId")) %>% 
  select(-starts_with("TotalTour")) %>% 
  mutate(percetage = TotalUSDPrize.x/TotalUSDPrize.y * 100)
  
  
lol_vs_total_earnings %>%
  ggplot() +
  geom_col(aes(x = prize_earnings/1000000,
               y = fct_reorder(TeamName, prize_earnings))) +
  facet_wrap(vars(variable))
```



## What is League of Legends?

- explain the orgins
- explain the game, map, and structure of the bases of the game
  - add pictures of the map and legendary players
  
## Professional League of Legends Esports

-use the data and explain its meaning
- use the high diamond ranked games data 
- use the pro matches to show the level and difference between diamond and pro player games

```{r echo = FALSE}

```

## Why is this game imapctful to Esports?

## DID YOU UNCOMMENT THE KNIT IN THE BEGINNING?